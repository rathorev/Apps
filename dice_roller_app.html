<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dice Roller</title>
  <style>
    :root { --bg:#0f1220; --card:#171a2b; --accent:#5eead4; --text:#e5e7eb; --muted:#9ca3af; }
    html, body { height:100%; -webkit-text-size-adjust:100%; }
    body { margin:0; font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif; background: radial-gradient(1200px 800px at 50% -10%, #1b213a 0%, var(--bg) 60%); color:var(--text); display:grid; place-items:center; }
    .app { width:min(520px,94vw); background: linear-gradient(180deg,#1a1f34 0%, var(--card) 100%); border:1px solid rgba(255,255,255,.06); border-radius:24px; box-shadow:0 20px 60px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.05); padding:20px 20px 16px; }
    header{ display:flex; align-items:center; justify-content:space-between; margin-bottom:6px; }
    h1{ font-size: clamp(18px,3.5vw,22px); margin:0; letter-spacing:.2px; }
    .muted{ color:var(--muted); font-size:12px; }
    .display{ display:grid; place-items:center; height: 42vh; max-height:360px; min-height:260px; border-radius:20px; background: radial-gradient(800px 400px at 50% -10%, #212846 0%, #131729 65%); border:1px solid rgba(255,255,255,.06); position:relative; overflow:hidden; margin:8px 0 14px; }
    .face{ font-size: clamp(110px,22vw,160px); line-height:1; text-rendering:optimizeLegibility; -webkit-font-smoothing: antialiased; transform: translateZ(0); filter: drop-shadow(0 10px 25px rgba(0,0,0,.45)); transition: transform 120ms ease-out; }
    .shake{ animation: shake 480ms cubic-bezier(.36,.07,.19,.97) both; }
    @keyframes shake{ 10%,90%{transform:translate3d(-1px,0,0) rotate(-1deg);} 20%,80%{transform:translate3d(2px,0,0) rotate(1deg);} 30%,50%,70%{transform:translate3d(-3px,0,0) rotate(-2deg);} 40%,60%{transform:translate3d(3px,0,0) rotate(2deg);} }
    .controls{ display:flex; gap:10px; justify-content:center; margin:8px 0 2px; }
    button{ -webkit-tap-highlight-color:transparent; appearance:none; border:0; cursor:pointer; padding:14px 18px; border-radius:14px; background: linear-gradient(180deg,#0ea5a0,#0b8e86); color:#051517; font-weight:700; letter-spacing:.3px; font-size:16px; box-shadow:0 8px 30px rgba(94,234,212,.35), inset 0 1px 0 rgba(255,255,255,.3); }
    button:active{ transform: translateY(1px); }
    .ghost{ background:#232846; color:var(--text); box-shadow: inset 0 1px 0 rgba(255,255,255,.05); }
    .row{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .history{ margin-top:12px; padding:10px 12px; border-radius:12px; background: rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.06); }
    .history h2{ font-size:13px; margin:0 0 8px; color:var(--muted); font-weight:600; letter-spacing:.3px; }
    .rolls{ display:flex; flex-wrap:wrap; gap:8px; }
    .chip{ padding:8px 10px; border-radius:10px; background:#1f2542; border:1px solid rgba(255,255,255,.06); font-weight:700; }
    footer{ margin-top:10px; text-align:center; font-size:12px; color:var(--muted); }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Dice roller app">
    <header>
      <h1>Dice Roller</h1>
      <span class="muted">Tap to roll a 6‚Äësided die</span>
    </header>

    <div class="display" aria-live="polite" aria-atomic="true">
      <div id="face" class="face" role="img" aria-label="die face">1</div>
    </div>

    <div class="controls">
      <button id="rollBtn" aria-label="Roll the die">Roll üé≤</button>
      <button id="resetBtn" class="ghost" aria-label="Reset history">Reset</button>
    </div>

    <div class="history" aria-label="history of recent rolls">
      <div class="row">
        <h2>Recent rolls</h2>
        <span class="muted" id="stats">‚Äî</span>
      </div>
      <div id="rolls" class="rolls"></div>
    </div>

    <footer>Offline-friendly. Add to Home Screen from Safari share menu.</footer>
  </div>

  <script>
    (function(){
      var unicodeFaces = ["‚öÄ","‚öÅ","‚öÇ","‚öÉ","‚öÑ","‚öÖ"]; // 1..6
      var usePips = false; // Safari fallback: start with numbers; switch to pips after first roll if supported
      var faceEl = document.getElementById('face');
      var rollsEl = document.getElementById('rolls');
      var statsEl = document.getElementById('stats');
      var rollBtn = document.getElementById('rollBtn');
      var resetBtn = document.getElementById('resetBtn');
      var historyLimit = 12; var history = [];

      function randomInt1to6(){
        try {
          if (window.crypto && window.crypto.getRandomValues) {
            var arr = new Uint32Array(1); window.crypto.getRandomValues(arr); return (arr[0] % 6) + 1;
          }
        } catch(e){}
        return Math.floor(Math.random()*6) + 1;
      }
      function vibrate(ms){ if (navigator.vibrate) { try { navigator.vibrate(ms); } catch(e){} } }
      function updateStats(){ if (!history.length) { statsEl.textContent = '‚Äî'; return; } var last = history[0]; var avg = (history.reduce(function(a,b){return a+b;},0)/history.length).toFixed(2); statsEl.textContent = 'Last: '+last+' ¬∑ Avg: '+avg; }
      function renderHistory(){ rollsEl.innerHTML=''; history.slice(0, historyLimit).forEach(function(n){ var div=document.createElement('div'); div.className='chip'; div.textContent = n; rollsEl.appendChild(div); }); updateStats(); }

      function setFace(n){
        faceEl.textContent = usePips ? unicodeFaces[n-1] : String(n);
        faceEl.setAttribute('aria-label', 'rolled '+n);
      }

      function roll(){
        faceEl.classList.remove('shake'); void faceEl.offsetWidth; faceEl.classList.add('shake');
        vibrate(35);
        setTimeout(function(){
          var n = randomInt1to6();
          // Try switching to pips once (if fonts available, Safari will render them)
          if (!usePips) { usePips = true; }
          setFace(n);
          history.unshift(n); renderHistory();
        }, 360);
      }

      function reset(){ history = []; renderHistory(); setFace(1); }

      rollBtn.addEventListener('click', roll);
      resetBtn.addEventListener('click', reset);
      document.addEventListener('keydown', function(e){ if (e.code === 'Space' || e.code === 'Enter') { e.preventDefault(); roll(); } });

      // First render
      reset();
    })();
  </script>
</body>
</html>
